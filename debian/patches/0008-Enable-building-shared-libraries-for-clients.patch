From: Balint Szente <balint@szentedwg.ro>
Date: Fri, 8 Mar 2013 08:08:44 -0300
Subject: Enable building shared libraries for clients

Patch taken from: https://jira.mongodb.org/browse/SERVER-6514
---
 src/SConscript.client |    8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/src/SConscript.client b/src/SConscript.client
index 74bd73c..bfbd654 100644
--- a/src/SConscript.client
+++ b/src/SConscript.client
@@ -3,7 +3,7 @@
 # This SConscript describes build and install rules for the Mongo C++ driver and associated exmaple
 # programs.
 
-Import('env clientEnv')
+Import('env clientEnv has_option')
 
 env.Command(['mongo/base/error_codes.h', 'mongo/base/error_codes.cpp',],
             ['mongo/base/generate_error_codes.py', 'mongo/base/error_codes.err'],
@@ -135,9 +135,11 @@ for path in clientHeaderDirectories:
     clientHeaders.extend(Glob('mongo/%s/*.hpp' % path))
 
 mongoclient_lib = env.Library('mongoclient', clientSource),
+if has_option( "sharedclient" ):
+    mongoclient_slib = env.SharedLibrary('mongoclient', clientSource)
 mongoclient_install = env.Install('#/', [
         mongoclient_lib,
-        #env.SharedLibrary('mongoclient', clientSource),
+        mongoclient_slib,
         ])
 env.Alias('mongoclient', mongoclient_install)
 
@@ -178,6 +180,8 @@ env.Install(
 prefix = GetOption("prefix")
 
 env.Install(prefix + "/lib", '${LIBPREFIX}mongoclient${LIBSUFFIX}')
+if has_option( "sharedclient" ):
+    env.Install(prefix + "/lib", '${SHLIBPREFIX}mongoclient${SHLIBSUFFIX}')
 
 for x in clientHeaderDirectories:
     inst = env.Install(prefix + "/include/mongo/" + x,
